前提：奖励函数十分重要，奖励函数的微调会带来巨大的影响。
假设存在一个专家智能体，其策略可以看成最优策略，我们就可以直接模仿这个专家在环境中交互的状态动作数据来训练一个策略，并且不需要用到环境提供的奖励信号。

![[IMG-20240103204008088.png]]
1. **行为克隆（Behavior Cloning, BC）**：这是一种简单的模仿学习方法，其中代理直接从专家的行为数据中学习，通过观察和复制这些行为来执行任务，类似于学生通过模仿老师的示例来学习。

2. **逆强化学习（Inverse Reinforcement Learning, IRL）**：这是一种从观察到的行为中推断出未知奖励函数的方法，它试图理解为什么专家会以特定的方式行动，而不仅仅是复制这些行动。

3. **生成式对抗模仿学习（Generative Adversarial Imitation Learning, GAIL）**：结合了生成式对抗网络（GANs）和模仿学习的技术，其中一个网络生成行为，另一个网络评估这些行为是否类似于专家的行为，通过这种对抗过程，代理学习模仿专家的行为。

# 行为克隆

直接使用监督学习的方法，将专家数据中的$(s_1,a_1)$ 中的$s_1$看作样本输入，$a_1$看作标签。目标为：

$$\theta^*=\arg\min_\theta\mathbb{E}_{(s,a)\sim B}[\mathcal{L}(\pi_\theta(s),a)]$$
其中，B是专家的数据集，L是对应监督学习框架下的损失函数。若动作是离散的，该损失函数可以是最大似然估计得到的。若动作是连续的，该损失函数可以是均方误差函数。

需要数据量较大，作为策略预训练，较为快速的提高机器策略行为的一种方法。
若数据量较小，则会带来复合误差的问题。（遇到专家数据没有见过的状态，就会随机选择一个策略，导致偏差越来越大）
![[IMG-20240103204640734.png]]
# 生成对抗模仿学习
GAIL是受到了生成式对抗网络（Generative Adversarial Networks，简称GANs）的启发。在GANs中，有两个部分：一个生成器（尝试创建看起来真实的数据）和一个鉴别器（尝试区分真实数据和生成器产生的数据）。这两个网络相互竞争，不断提高各自的性能。
GAIL将这种思想应用到模仿学习中。在GAIL中，我们有一个生成器，这里是模仿专家行为的代理；还有一个鉴别器，它的任务是区分代理的行为和专家的行为。代理（生成器）尝试以一种让鉴别器难以区分它和专家行为的方式行动，而鉴别器则尝试变得更擅长区分这两者。通过这种对抗过程，代理逐渐学会模仿专家的行为。

### 定义和背景

GAIL结合了生成式对抗网络（GAN）的思想与模仿学习。在GAIL框架中，模仿学习被公式化为一个最小-最大优化问题，其中包括一个生成模型（代理）和一个鉴别模型（鉴别器）。

- **生成模型（代理）**：试图模仿专家的策略，生成行为序列。
- **鉴别模型（鉴别器）**：区分代理生成的行为和专家行为。

### 核心公式

GAIL的目标是最小化以下目标函数：

$$ \min_{\theta} \max_{\omega} \mathbb{E}_{\pi_{\theta}}[\log(D_{\omega}(s,a))] + \mathbb{E}_{\pi_{E}}[\log(1 - D_{\omega}(s,a))] - \lambda H(\pi_{\theta}) $$

其中：

- $\theta$ 表示代理的策略参数。
- $\omega$ 表示鉴别器的参数。
- $\pi_{\theta}$ 是代理的策略，即生成模型。
- $\pi_{E}$ 是专家的策略。
- $D_{\omega}(s,a)$ 是鉴别器的输出，表示在状态 $s$ 下，行动 $a$ 来自专家的概率。
- $H(\pi_{\theta})$ 是代理策略的熵，用于鼓励探索。
- $\lambda$ 是一个正则化项的权重，控制熵的重要性。

### 工作流程

1. **训练鉴别器**：使用专家数据和代理生成的数据来训练鉴别器。目标是最大化能够区分来自代理和专家的行为。
2. **优化代理策略**：通过强化学习方法（如策略梯度）来优化代理的策略，使其行为更难被鉴别器区分，即生成类似于专家的行为。
3. **迭代过程**：交替进行鉴别器的训练和代理策略的优化，直到代理生成的行为与专家行为足够相似，使鉴别器难以区分。

### 关键点

- **模仿专家行为**：GAIL不直接从专家行为中学习，而是通过对抗过程来学习生成类似专家的行为。
- **平衡探索和模仿**：通过熵正则化，确保代理在模仿的同时保持一定的探索性。
- **强化学习和GAN的结合**：利用GAN的框架在模仿学习中引入了对抗性训练，这是GAIL的核心创新。







